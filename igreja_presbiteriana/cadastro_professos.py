# Form implementation generated from reading ui file 'cadastro_professos.ui'
#
# Created by: PyQt6 UI code generator 6.9.1
#
# WARNING: Any manual changes made to this file will be lost when pyuic6 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt6 import QtCore, QtGui, QtWidgets
from conect_banco import cadastrar_professo,buscar_professo_por_nome,cadastrar_professo_transferido
from PyQt6.QtWidgets import  QFileDialog
class Ui_cadastrar_professo(QtWidgets.QWidget):
    def __init__(self,parent):
        super().__init__()
        self.parent=parent
        self.setupUi(self)
    def setupUi(self, Widget):
        Widget.setObjectName("Widget")
        Widget.resize(1214, 328)
        self.layoutWidget = QtWidgets.QWidget(parent=Widget)
        self.layoutWidget.setGeometry(QtCore.QRect(30, 140, 1131, 321))
        self.layoutWidget.setObjectName("layoutWidget")
        self.layout_principal = QtWidgets.QVBoxLayout(Widget)
        self.layout_principal.setContentsMargins(0, 0, 0, 0)
        self.layout_principal.setObjectName("layout_principal")
        self.label = QtWidgets.QLabel(parent=self.layoutWidget)
        font = QtGui.QFont()
        font.setPointSize(20)
        font.setBold(True)
        self.label.setFont(font)
        self.label.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        self.label.setObjectName("label")
        self.layout_principal.addWidget(self.label)
        self.layout_cadastro_principal = QtWidgets.QVBoxLayout()
        self.layout_cadastro_principal.setObjectName("layout_cadastro_principal")
        self.layout_1 = QtWidgets.QHBoxLayout()
        self.layout_1.setObjectName("layout_1")
        self.layout_nome = QtWidgets.QHBoxLayout()
        self.layout_nome.setObjectName("layout_nome")
        self.titulo_nome = QtWidgets.QLabel(parent=self.layoutWidget)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        self.titulo_nome.setFont(font)
        self.titulo_nome.setObjectName("titulo_nome")
        self.layout_nome.addWidget(self.titulo_nome)
        self.nome_entrada = QtWidgets.QLineEdit(parent=self.layoutWidget)
        self.nome_entrada.setObjectName("nome_entrada")
        self.layout_nome.addWidget(self.nome_entrada)
        self.layout_1.addLayout(self.layout_nome)
        self.layout_endereco = QtWidgets.QHBoxLayout()
        self.layout_endereco.setObjectName("layout_endereco")
        self.endereo_nome = QtWidgets.QLabel(parent=self.layoutWidget)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        self.endereo_nome.setFont(font)
        self.endereo_nome.setObjectName("endereo_nome")
        self.layout_endereco.addWidget(self.endereo_nome)
        self.entrada_endereco = QtWidgets.QLineEdit(parent=self.layoutWidget)
        self.entrada_endereco.setObjectName("entrada_endereco")
        self.layout_endereco.addWidget(self.entrada_endereco)
        self.layout_1.addLayout(self.layout_endereco)
        self.layout_cadastro_principal.addLayout(self.layout_1)
        self.layout_2 = QtWidgets.QHBoxLayout()
        self.layout_2.setObjectName("layout_2")
        self.layoutidentidade = QtWidgets.QHBoxLayout()
        self.layoutidentidade.setObjectName("layoutidentidade")
        self.texto_identidade = QtWidgets.QLabel(parent=self.layoutWidget)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        self.texto_identidade.setFont(font)
        self.texto_identidade.setObjectName("texto_identidade")
        self.layoutidentidade.addWidget(self.texto_identidade)
        self.entrada_identidade = QtWidgets.QLineEdit(parent=self.layoutWidget)
        self.entrada_identidade.setObjectName("entrada_identidade")
        self.layoutidentidade.addWidget(self.entrada_identidade)
        self.layout_2.addLayout(self.layoutidentidade)
        self.layout_cpf = QtWidgets.QHBoxLayout()
        self.layout_cpf.setObjectName("layout_cpf")
        self.titulo_cpf = QtWidgets.QLabel(parent=self.layoutWidget)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        self.titulo_cpf.setFont(font)
        self.titulo_cpf.setObjectName("titulo_cpf")
        self.layout_cpf.addWidget(self.titulo_cpf)
        self.entrada_cpf = QtWidgets.QLineEdit(parent=self.layoutWidget)
        self.entrada_cpf.setObjectName("entrada_cpf")
        self.layout_cpf.addWidget(self.entrada_cpf)
        self.layout_2.addLayout(self.layout_cpf)
        self.horizontalLayout = QtWidgets.QHBoxLayout()
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.titulo_telefone = QtWidgets.QLabel(parent=self.layoutWidget)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        self.titulo_telefone.setFont(font)
        self.titulo_telefone.setObjectName("titulo_telefone")
        self.horizontalLayout.addWidget(self.titulo_telefone)
        self.entrada_telefone = QtWidgets.QLineEdit(parent=self.layoutWidget)
        self.entrada_telefone.setObjectName("entrada_telefone")
        self.horizontalLayout.addWidget(self.entrada_telefone)
        self.layout_2.addLayout(self.horizontalLayout)
        self.layout_nascimento = QtWidgets.QHBoxLayout()
        self.layout_nascimento.setObjectName("layout_nascimento")
        self.texto_data_nascimento = QtWidgets.QLabel(parent=self.layoutWidget)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        self.texto_data_nascimento.setFont(font)
        self.texto_data_nascimento.setObjectName("texto_data_nascimento")
        self.layout_nascimento.addWidget(self.texto_data_nascimento)
        self.entrada_data_nascimento = QtWidgets.QDateEdit(parent=self.layoutWidget)
        self.entrada_data_nascimento.setObjectName("entrada_data_nascimento")
        self.layout_nascimento.addWidget(self.entrada_data_nascimento)
        self.layout_2.addLayout(self.layout_nascimento)
        self.layout_cadastro_principal.addLayout(self.layout_2)
        self.layout_3 = QtWidgets.QHBoxLayout()
        self.layout_3.setObjectName("layout_3")
        self.layout_cadastro_principal.addLayout(self.layout_3)
        self.layout_principal.addLayout(self.layout_cadastro_principal)
        self.layout_genero= QtWidgets.QHBoxLayout()
        self.titulo_nome_4 = QtWidgets.QLabel("GENERO")
        font = self.titulo_nome_4.font()
        font.setPointSize(12)
        font.setBold(True)
        self.titulo_nome_4.setFont(font)
        self.layout_genero.addWidget(self.titulo_nome_4)
        self.masculino = QtWidgets.QRadioButton("Masculino")
        self.layout_genero.addWidget(self.masculino)
        self.feminino = QtWidgets.QRadioButton("Feminino")
        self.layout_genero.addWidget(self.feminino)

        self.layout_forma_admissao = QtWidgets.QHBoxLayout()
        self.layout_forma_admissao.setObjectName("layout_forma_admissao")
        self.titulo_nome_2 = QtWidgets.QLabel(parent=self.layoutWidget)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        self.titulo_nome_2.setFont(font)
        self.titulo_nome_2.setObjectName("titulo_nome_2")
        self.layout_forma_admissao.addLayout(self.layout_genero)
        self.layout_forma_admissao.addWidget(self.titulo_nome_2)
        self.comboBox = QtWidgets.QComboBox(parent=self.layoutWidget)
        self.comboBox.setObjectName("comboBox")
        self.layout_forma_admissao.addWidget(self.comboBox)
        self.widget_data_ppfb = QtWidgets.QWidget(parent=self.layoutWidget)
        self.widget_data_ppfb.setObjectName("widget_data_ppfb")
        self.layout_data_ppfb = QtWidgets.QHBoxLayout(self.widget_data_ppfb)
        self.layout_data_ppfb.setObjectName("layout_data_ppfb")
        spacerItem = QtWidgets.QSpacerItem(15, 20, QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Minimum)
        self.layout_data_ppfb.addItem(spacerItem)
        self.texto_data_ppfb = QtWidgets.QLabel(parent=self.widget_data_ppfb)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        self.texto_data_ppfb.setFont(font)
        self.texto_data_ppfb.setObjectName("texto_data_ppfb")
        self.layout_data_ppfb.addWidget(self.texto_data_ppfb)
        self.entrada_data_ppfb = QtWidgets.QDateEdit(parent=self.widget_data_ppfb)
        self.entrada_data_ppfb.setObjectName("entrada_data_ppfb")
        self.layout_data_ppfb.addWidget(self.entrada_data_ppfb)
        self.layout_forma_admissao.addWidget(self.widget_data_ppfb)
        spacerItem1 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Minimum)
        self.layout_forma_admissao.addItem(spacerItem1)
        self.layout_principal.addLayout(self.layout_forma_admissao)
        self.widget_igreja_traferida = QtWidgets.QWidget(parent=self.layoutWidget)
        self.widget_igreja_traferida.setObjectName("widget_igreja_traferida")
        self.layout_greja_trans_4 = QtWidgets.QHBoxLayout(self.widget_igreja_traferida)
        self.layout_greja_trans_4.setObjectName("layout_greja_trans_4")
        self.horizontalLayout_3 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_3.setObjectName("horizontalLayout_3")
        self.titulo_igreja_transferida = QtWidgets.QLabel(parent=self.widget_igreja_traferida)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        self.titulo_igreja_transferida.setFont(font)
        self.titulo_igreja_transferida.setObjectName("titulo_igreja_transferida")
        self.horizontalLayout_3.addWidget(self.titulo_igreja_transferida)
        self.entrada_igreja_transferida = QtWidgets.QLineEdit(parent=self.widget_igreja_traferida)
        self.entrada_igreja_transferida.setObjectName("entrada_igreja_transferida")
        self.horizontalLayout_3.addWidget(self.entrada_igreja_transferida)
        self.layout_greja_trans_4.addLayout(self.horizontalLayout_3)
        self.horizontalLayout_4 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_4.setObjectName("horizontalLayout_4")
        self.titulo_tranferida = QtWidgets.QLabel(parent=self.widget_igreja_traferida)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        self.titulo_tranferida.setFont(font)
        self.titulo_tranferida.setObjectName("titulo_tranferida")
        self.horizontalLayout_4.addWidget(self.titulo_tranferida)
        self.entrada_data_transferida = QtWidgets.QDateEdit(parent=self.widget_igreja_traferida)
        self.entrada_data_transferida.setObjectName("entrada_data_transferida")
        self.horizontalLayout_4.addWidget(self.entrada_data_transferida)
        self.layout_greja_trans_4.addLayout(self.horizontalLayout_4)
        self.layout_carta_transferencia = QtWidgets.QHBoxLayout()
        self.layout_carta_transferencia.setObjectName("layout_carta_transferencia")
        self.titulo_nome_3 = QtWidgets.QLabel(parent=self.widget_igreja_traferida)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        self.titulo_nome_3.setFont(font)
        self.titulo_nome_3.setObjectName("titulo_nome_3")
        self.layout_carta_transferencia.addWidget(self.titulo_nome_3)
        self.pushButton_2 = QtWidgets.QPushButton(parent=self.widget_igreja_traferida)
        self.pushButton_2.setObjectName("pushButton_2")
        self.layout_carta_transferencia.addWidget(self.pushButton_2)
        self.layout_greja_trans_4.addLayout(self.layout_carta_transferencia)
        self.layout_principal.addWidget(self.widget_igreja_traferida)
        self.layout_botao_cadastrar = QtWidgets.QHBoxLayout()
        self.layout_botao_cadastrar.setSizeConstraint(QtWidgets.QLayout.SizeConstraint.SetNoConstraint)
        self.layout_botao_cadastrar.setSpacing(0)
        self.layout_botao_cadastrar.setObjectName("layout_botao_cadastrar")
        self.pushButton = QtWidgets.QPushButton(parent=self.layoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Fixed, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.pushButton.sizePolicy().hasHeightForWidth())
        self.pushButton.setSizePolicy(sizePolicy)
        self.pushButton.setObjectName("pushButton")
        self.layout_botao_cadastrar.addWidget(self.pushButton)
        self.layout_principal.addLayout(self.layout_botao_cadastrar)

        self.retranslateUi(Widget)
        QtCore.QMetaObject.connectSlotsByName(Widget)

    def retranslateUi(self, Widget):
        _translate = QtCore.QCoreApplication.translate
        Widget.setWindowTitle(_translate("Widget", "Widget"))
        self.label.setText(_translate("Widget", "Cadastro de Professos"))
        self.titulo_nome.setText(_translate("Widget", "Nome completo :"))
        self.endereo_nome.setText(_translate("Widget", "endereço:"))
        self.texto_identidade.setText(_translate("Widget", "Identidade:"))
        self.titulo_cpf.setText(_translate("Widget", "CPF:"))
        self.titulo_telefone.setText(_translate("Widget", "Telefone:"))
        self.texto_data_nascimento.setText(_translate("Widget", "Data Nascimento"))
        self.titulo_nome_2.setText(_translate("Widget", "Forma de admissão:"))
        lista_admissao=["Profissão de fé","Profissão de fé e batismo","Carta de Transferencia","Jurisdição a Pedido","Jurisdição ex Oficio","Restauração do afastados","Designação do Presbiterio","Outros"]
        for i,item in enumerate(lista_admissao):
            self.comboBox.addItem("")
            self.comboBox.setItemText(i, _translate("Widget", str(item)))
        self.texto_data_ppfb.setText(_translate("Widget", "Data PPFB:"))
        self.titulo_igreja_transferida.setText(_translate("Widget", "Igreja tranferida"))
        self.titulo_tranferida.setText(_translate("Widget", "Data de tranferencia"))
        self.titulo_nome_3.setText(_translate("Widget", "Carta de Transferencia"))
        self.pushButton_2.setText(_translate("Widget", "Selecione o arquivo"))
        self.pushButton.setText(_translate("Widget", "Cadastrar"))
        self.widget_igreja_traferida.setVisible(False)
        self.comboBox.currentTextChanged.connect(self.Igreja_trasferida)
        self.pushButton_2.clicked.connect(self.selecionar_pdf)
        self.arquivo=''
        self.pushButton.clicked.connect(self.pegar_dados_validar)
    def Igreja_trasferida(self):
        if self.comboBox.currentText() == "Carta de Transferencia":
            self.widget_igreja_traferida.setVisible(True)
        else:
            self.widget_igreja_traferida.setVisible(False)
    def pegar_dados_validar(self):
        nome=self.nome_entrada.text()
        endereco=self.entrada_endereco.text()
        identidade=self.entrada_identidade.text()
        cpf=self.entrada_cpf.text()
        telefone=self.entrada_telefone.text()
        data_nascimento=self.entrada_data_nascimento.date().toString("dd/MM/yyyy")
        forma_admissao=self.comboBox.currentText()
        data_ppfb=self.entrada_data_ppfb.date().toString("dd/MM/yyyy")
        genero=''
                

        
        if (self.masculino.isChecked() or self.feminino.isChecked()):
              if self.masculino.isChecked() :
                    genero='Maculino'
              elif self.feminino.isChecked():
                   genero='Feminino'
              cadastro=cadastrar_professo( nome,endereco,data_ppfb,data_nascimento,identidade,cpf,telefone,forma_admissao,genero)
              if cadastro:
                if forma_admissao == "Carta de Transferencia":
                        igreja_transferida=self.entrada_igreja_transferida.text()
                        data_transferencia=self.entrada_data_transferida.date().toString("dd/MM/yyyy")
                        id=str(buscar_professo_por_nome(nome)['id_professo'])  
                        cadastrado_professo_tranferido=cadastrar_professo_transferido(id_professo=id,igreja_transferida=igreja_transferida,data_transferencia=data_transferencia,carta=self.arquivo) 
                        if cadastrado_professo_tranferido:
                                msg = QtWidgets.QMessageBox()
                                msg.setIcon(QtWidgets.QMessageBox.Icon.Information)
                                msg.setWindowTitle("Cadastro Concluído")
                                msg.setText("Cadastro efetuado com sucesso!")
                                msg.setStandardButtons(QtWidgets.QMessageBox.StandardButton.Ok)
                                msg.exec()
                                if self.parent:
                                         self.parent.prencher_tabela()
                        else:
                                msg = QtWidgets.QMessageBox()
                                msg.setIcon(QtWidgets.QMessageBox.Icon.Information)
                                msg.setWindowTitle("ERRO")
                                msg.setText("Erro em cadastrar nos traferidos")
                                msg.setStandardButtons(QtWidgets.QMessageBox.StandardButton.Ok)
                                msg.exec()
                else: 
                        msg = QtWidgets.QMessageBox()
                        msg.setIcon(QtWidgets.QMessageBox.Icon.Information)
                        msg.setWindowTitle("Cadastro Concluído")
                        msg.setText("Cadastro efetuado com sucesso!")
                        msg.setStandardButtons(QtWidgets.QMessageBox.StandardButton.Ok)
                        msg.exec()
                             
                      
        else:
            msg=QtWidgets.QMessageBox()
            msg.setIcon(QtWidgets.QMessageBox.Icon.Information)
            msg.setWindowTitle("Erro")
            msg.setText("Selecione um Genero")
            msg.exec()

    def selecionar_pdf(self):
        # Abre o explorador de arquivos
        arquivo, _ = QFileDialog.getOpenFileName(self, "Selecione um PDF", "", "Arquivos PDF (*.pdf)")
        
        if arquivo:
            try:
                with open(arquivo, "rb") as f:
                    pdf_data = f.read()

                nome_arquivo = arquivo.split("/")[-1]  # só o nome do arquivo
                self.arquivo=pdf_data

            except Exception as e:
                QtWidgets.QMessageBox.critical(self, "Erro", str(e))


